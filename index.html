<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>나의 Firebase 퀴즈 앱</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: sans-serif;
            @apply bg-gray-100;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center">
    
    <!-- Firebase SDK Scripts -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // 여기에 Firebase 프로젝트 설정을 입력하세요!
        // 예시: const firebaseConfig = { apiKey: "...", authDomain: "...", ... };
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyCKUUty_87HsQIlpsSNZunnHpULAlM32Pc",
  authDomain: "quiz-gamgule.firebaseapp.com",
  projectId: "quiz-gamgule",
  storageBucket: "quiz-gamgule.firebasestorage.app",
  messagingSenderId: "338874271866",
  appId: "1:338874271866:web:ea13115a67b9c182fcd3c3",
  measurementId: "G-S7ML16E2CY"
};

        // Firebase 초기화
        let app, auth, db;
        try {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
            console.log("Firebase 앱이 초기화되었습니다.");
        } catch (e) {
            console.error("Firebase 초기화 중 오류 발생:", e);
        }

        const quizForm = document.getElementById('quizForm');
        
        quizForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const name = document.getElementById('name').value;
            const answer = document.getElementById('answer').value;

            if (!name || !answer) {
                alert('이름과 답을 모두 입력해주세요.');
                return;
            }
            
            try {
                // 익명으로 로그인하여 사용자 UID 가져오기 (데이터 저장용)
                const userCredential = await signInAnonymously(auth);
                const userId = userCredential.user.uid;

                // Firestore에 데이터 추가
                await addDoc(collection(db, "answers"), {
                    userId: userId,
                    name: name,
                    answer: answer,
                    timestamp: new Date()
                });

                alert('답변이 성공적으로 제출되었습니다!');
                quizForm.reset();
                
            } catch (error) {
                console.error("답변 제출 중 오류 발생: ", error);
                alert('답변 제출에 실패했습니다. 콘솔을 확인해주세요.');
            }
        });

    </script>

    <!-- Quiz UI -->
    <div class="bg-white p-8 rounded-lg shadow-md max-w-sm w-full mx-auto">
        <h1 class="text-2xl font-bold mb-6 text-center text-orange-500">퀴즈에 답하기</h1>
        
        <form id="quizForm" class="space-y-4">
            <div>
                <label for="name" class="block text-sm font-medium text-gray-700">이름</label>
                <input type="text" id="name" name="name" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm">
            </div>
            
            <div>
                <label for="answer" class="block text-sm font-medium text-gray-700">답변</label>
                <textarea id="answer" name="answer" rows="4" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm"></textarea>
            </div>
            
            <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500">
                제출하기
            </button>
        </form>
    </div>
    
</body>
</html>
